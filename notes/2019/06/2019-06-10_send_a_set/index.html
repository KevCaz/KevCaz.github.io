<!doctype html><html lang=en-us><head><title>KevCaz's Website</title>
<link rel=stylesheet href=https://kevcaz.github.io/css/main.min.2e0874d93dedc5b86cd2d2b471abad3b89e2cad618d46f8b7d6ef32f24918729.css media=screen><link rel=stylesheet href=../../../../css/perso.css><link rel=stylesheet href=../../../../css/family.css><meta name=author content="Kevin Cazelles"><meta name=institution content="Department of Integrated Biology, University of Guelph"><meta name=news_keywords content="[Atom cli gnome-terminal window manager xclip xdotool xsel]"><meta property="og:site_name" content="KevCaz's Website"><meta property="og:title" content="Send a set of command lines to GNOME Terminal"><meta property="og:image" content="https://kevcaz.github.io/img/imgOG/kevcaz_og.png"><meta property="og:description" content="Kevin Cazelles's website"></head><body><div class=page><div class=ctn-sidebar-primary><div class=ctt-sidebar-primary><h1>KevCaz's Website</h1><div class=primary-sidebar-premenu><h2><i class='fas fa-align-center'></i> <button onclick='dropDown("p-s-menu")'> Menu</button></h2></div><div class=primary-sidebar-menu id=p-s-menu><h2><a href=../../../../><i class='fas fa-home'></i> Home</a></h2><h2><a onclick='dropDown("dropdown-research")' href=javascript:void(0)><i class='fas fa-microscope'></i> Research</a></h2><div class=dropdown id=dropdown-research><h3><a href=../../../../about_my_research/>About my research</a></h3><h3><a href=../../../../publications/>Publications</a></h3><h3><a href=../../../../software/>Software</a></h3><h3><a href=../../../../talks/>Talks & Posters</a></h3><h3><a href=../../../../teaching/>Teaching</a></h3></div><h2 id=current-dropdown><a onclick='dropDown("dropdown-blog")' href=javascript:void(0)><i class='fas fa-blog'></i> Blog</a></h2><div class=dropdown-current id=dropdown-blog><h3><a href=../../../../econotes/>EcoNotes</a></h3><h3 id=current><a href=../../../../notes/>SilicoNotes</a></h3><h3><a href=https://insileco.github.io/>inSilecoBlog</a></h3></div><h2><a onclick='dropDown("dropdown-perso")' href=javascript:void(0)><i class='fas fa-person-booth'></i> Miscelleneous</a></h2><div class=dropdown id=dropdown-perso><h3><a href=../../../../perso/books>Books</a></h3><h3><a href=../../../../perso/movies>Movies</a></h3><h3><a href=../../../../perso/opinions>Opinions</a></h3></div></div><div class=footer><hr id=hr-footer align=left><div class=social-media-banner><a href=https://github.com/KevCaz><i class='fab fab fa-github-square'></i></a>
<a href=https://stackoverflow.com/users/8038778><i class='fab fa-stack-overflow'></i></a>
<a href=https://mastodon.social/@KCazelles><i class='fab fa-mastodon'></i></a>
<a href=http://orcid.org/0000-0001-6619-9874><i class='ai ai-orcid-square'></i></a>
<a href="https://scholar.google.ca/citations?user=xzvcu7cAAAAJ%26hl"><i class='ai ai-google-scholar-square'></i></a>
<a href=https://www.researchgate.net/profile/Kevin_Cazelles><i class='ai ai-researchgate-square'></i></a>
<a href=https://kevcaz.github.io/index.xml><i class="fas fa-rss-square"></i></a></div><div class=footer-custom>Website built with <a href=https://gohugo.io/>Hugo</a>.<br><i class='fas fa-code'></i> available on <a href=https://github.com/KevCaz/KevCaz.github.io><i class='fab fa-github'></i></a>.<br>Content under <a href=https://creativecommons.org/publicdomain/zero/1.0><i class='fab fa-creative-commons'></i><i class='fab fa-creative-commons-zero'></i></a> unless otherwise specified.<br>Latest build: 01 Feb 2025 04:45 UTC</div></div></div></div><div class=ctn-main-content><div class=ctt-main-content><div class=article-meta><h1 id=title>Send a set of command lines to GNOME Terminal</h1><h3 class=date>June 10, 2019<div class=tags><i class="fas fa-tags" aria-hidden=true></i> &nbsp;
<a href=../../../../tags/atom><kbd class=item-tag>Atom</kbd></a>
<a href=../../../../tags/cli><kbd class=item-tag>cli</kbd></a>
<a href=../../../../tags/gnome-terminal><kbd class=item-tag>gnome-terminal</kbd></a>
<a href=../../../../tags/window-manager><kbd class=item-tag>window manager</kbd></a>
<a href=../../../../tags/xclip><kbd class=item-tag>xclip</kbd></a>
<a href=../../../../tags/xdotool><kbd class=item-tag>xdotool</kbd></a>
<a href=../../../../tags/xsel><kbd class=item-tag>xsel</kbd></a></div></div><div class=article-main><h2 id=context>Context</h2><p>As mentioned several times on this website, I use <a href=https://atom.io/>Atom</a> for
my coding as well as for writing posts and manuscripts. While coding, one often
needs to run commands in a terminal. To do so, I use specific Atom packages such
as <a href=https://atom.io/packages/ide-r>IDE-R</a> or <a href=https://github.com/JunoLab/atom-julia-client>Julia
Client</a> to run R and Julia
commands respectively and
<a href=https://github.com/platformio/platformio-atom-ide-terminal>platformio-ide-terminal</a>.
The latter meets most of my expectations, but:</p><ol><li><p>the terminal emulated is in a bottom panel and when I&rsquo;m working on my laptop I cannot get a good overview of the code and the corresponding outputs at the same time, pretty annoying&mldr; and having the terminal in the right panel is a <a href=https://github.com/platformio/platformio-atom-ide-terminal/issues/198>feature unlikely to be implemented in a near future</a>;</p></li><li><p>in many cases, I&rsquo;d prefer to run command lines in a terminal emulator that is
not a child process of Atom so that the commands are run independently from it.</p></li></ol><p>The solution I&rsquo;ve envisioned for a while now is to use Atom for coding and run
the commands in GNOME terminal (which I very much like, <a href=http://www.linuxandubuntu.com/home/10-best-linux-terminals-for-ubuntu-and-fedora>but many good
alternatives
exist</a>. Of course I have always been able to do so, but I had to copy paste every code chunk &#x2b07;&#xfe0f;.</p><center><video width=100% controls>
<source src=./assets/copypaste.webm type=video/webm>Your browser does not support the video tag.</video></center><p>And this has always been bothering me (more than it should have) for a long time
now. So last weekend I decided to find a way to get a shortcut that would
directly send command lines to GNOME Terminal and execute it.</p><p>There actually is an Atom package to send command to Terminal,
<a href=https://atom.io/packages/r-exec>r-exec</a>, but it only works for MacOS as it
uses
<a href=https://developer.apple.com/library/archive/documentation/AppleScript/Conceptual/AppleScriptX/AppleScriptX.html>AppleScript</a>. So, all I had to do was to do an Linux equivalent of r-exec, no less&mldr; I rolled up my sleeves and
read and code and read and code and finally came out with a solution &#x1f604;!</p><h2 id=solution>Solution</h2><h3 id=requirements>Requirements</h3><p>Before detailing the bash script I created, I must mention a couple of important point about prerequisites. First, here is my current OS and desktop environment (I&rsquo;ve used <a href=https://github.com/smxi/inxi>inxi</a> to share these infos):</p><pre tabindex=0><code>$ inxi -S
System:
 Host: debkev Kernel: 4.19.0-5-amd64 x86_64 bits: 64
 Desktop: Gnome 3.30.2 Distro: Debian GNU/Linux 10 (buster)
</code></pre><p>Second, <strong>the solution below only works if GNOME is running atop
<a href=https://www.x.org/wiki/>X.org</a></strong>, not on
<a href=https://wayland.freedesktop.org/>Walyand</a> which is <a href="https://www.phoronix.com/scan.php?page=news_item&px=Debian-10-GNOME-Wayland-vs-X">the default on Debian
Buster</a>. In my case, the very first step was to go back to <a href=https://www.x.org/wiki/>X.org</a>. To do so, I commented the line <code>WaylandEnable=false</code> in <code>/etc/gdm3/daemon.conf</code> &#x2b07;&#xfe0f;:</p><center><img src=./assets/backtoXorg.png width=65%></center><br><p>That being said, if you are using a UNIX distro and your terminal window is managed by X.org, it should fairly easy to adapt the approach below.</p><h3 id=bash-script>Bash script</h3><p>In order to use the script, <code>xclip</code> and <code>xdotool</code> must be installed:</p><pre tabindex=0><code># apt-get install xclip xdotool
</code></pre><p>The bash script I&rsquo;ve created automates 4 operations:</p><ol><li><p>it copy-pastes the current selection with <a href=https://github.com/astrand/xcli>xclip</a>;</p></li><li><p>it calls <a href=https://github.com/jordansissel/xdotool>xdotool</a> to identify where GNOME-Terminal windows and use the id of the last one (with <code>tail</code>);</p></li><li><p>it changes the focused window with <code>xdotool</code>;</p></li><li><p>it pastes the content of the clipboard in the Terminal and executes the command via <code>xdotool</code>.</p></li></ol><p>Here is the bash script I used:</p><pre tabindex=0><code>#!/bin/bash
# Current selection to clipboard
xclip -o -selection primary | xclip -i -selection clipboard

# pause to let me have all my keys are up
# see https://stackoverflow.com/questions/34092604
sleep .1

# Find the last gnome terminal window
w=$(xdotool search --class gnome-terminal | tail -1)

# test if a terminal is actually open, otherwise opens one
if ! [[ $w =~ [0-9]+ ]]; then
  gnome-terminal
  w=$(xdotool search --class gnome-terminal | tail -1)
fi

# focus on the right window
xdotool windowfocus $w

# paste the command (ctrl+shift+v) and execute it (Return)
xdotool key --clearmodifiers ctrl+shift+v Return
</code></pre><p>The final step was to create a <a href=https://docs.fedoraproject.org/en-US/quick-docs/proc_setting-key-shortcut/>key
shortcut</a>
that triggers this script (which I named <code>tognuterm</code> and turned into an
executable with <code>chmod 755 tognuterm</code>). This works pretty well &#x1f386;
&#x1f525; &#x1f4a5; and not only I can easily run any command from Atom but I also can run a command from any
application (for instance, from my Internet browser &#x1f609;).</p><center><video width=100% controls>
<source src=./assets/newshortcut.webm type=video/webm>Your browser does not support the video tag.</video></center><h3 id=important-notes>Important notes</h3><h4 id=extra-readings>Extra readings</h4><p>First of all, in order to create the script above I&rsquo;ve got good hints reading <a href=https://unix.stackexchange.com/questions/11889/pasting-x-selection-not-clipboard-contents-with-keyboard>this answer on <i class="fab fa-stack-exchange"></i></a>! Second, there is a tool similar to <code>xclip</code>: <a href=https://github.com/kfish/xsel>xsel</a> that you can use here (see below) and <a href=https://fernandobasso.github.io/shell/copy-paste-from-command-line-xclip-xsel-clipboard.html>Fernando Basso wrote a nice piece about these two</a> that I strongly recommend (obviously, you should also look at the documentation: <code>man xclip</code> and <code>man xdotool</code>). Third, you should better read a bit about <code>xdotool</code> as it is pretty handy: it simulates keyboard input and mouse activity, so you can create script that resize windows, enter keys, <a href="https://www.youtube.com/watch?v=SIjumbdkq_w">clicks</a>, etc. Note that due to its nature, it does interact with your own activity and <a href=https://stackoverflow.com/questions/34092604/xdotool-why-sleep-before-running-commands>that is why using <code>sleep</code> could be useful</a>, it took me some time to understand this but it explains why some time your script does not work!</p><h4 id=using-xsel-instead-of-xlip>Using <code>xsel</code> instead of <code>xlip</code></h4><p>Here, <code>xsel</code> and <code>xclip</code> are interchangeable, you can use either and even the two of them. If you prefer <code>xsel</code> over <code>xclip</code>, simply replace the line <code>xclip -o -selection primary | xclip -i -selection clipboard</code> by <code>xsel | xsel --clipboard</code>.</p><h3 id=only-xdotool-approach>Only <code>xdotool</code> approach</h3><p>You can actually simulate a copy event with <code>xdotool</code> instead of using <code>xsel</code> or <code>xclip</code>. I refrained using this approach because ultimately, I would rather opt for a solution that do not require to simulate keyboard events. Anyway, it you want to give it a try, you can replace <code>xclip -o -selection primary | xclip -i -selection clipboard</code> by <code>xdotool key --clearmodifiers ctrl+c</code> and for the reasons explained above you better add a pause before the command (e.g. <code>sleep .2</code>).</p><h3 id=using-another-terminal-emulator>Using another Terminal emulator</h3><p>The solution should work with any terminal emulator, you simply need to use the
relevant <code>xdotool search</code> command. For instance, if you want to use
<a href=https://gnometerminator.blogspot.com/p/introduction.html>Terminator</a>, the
search command should be <code>xdotool search --class terminator</code>. If you do not know
how to retrieve info about about windows, check <a href=https://linux.die.net/man/1/xwininfo><code>xwininfo</code></a> out!</p><h2 id=concluding-remarks>Concluding remarks</h2><ol><li><p>The solution I came up with is far from being perfect, but it works well and it is a good starting point. If I improve it in a near future, I&rsquo;ll write another note about this!</p></li><li><p>Looks like Wayland is meant to replace X.org, so I&rsquo;d better think about a solution that would work on Wayland&mldr; Again, IMHO, the best approach should not depend on a specific window manager.</p></li></ol><h3 id=thats-all-folks>That&rsquo;s all folks!</h3></div></div><div class=footer2><hr id=hr-footer align=left><div class=social-media-banner><a href=https://github.com/KevCaz><i class='fab fab fa-github-square'></i></a>
<a href=https://stackoverflow.com/users/8038778><i class='fab fa-stack-overflow'></i></a>
<a href=https://mastodon.social/@KCazelles><i class='fab fa-mastodon'></i></a>
<a href=http://orcid.org/0000-0001-6619-9874><i class='ai ai-orcid-square'></i></a>
<a href="https://scholar.google.ca/citations?user=xzvcu7cAAAAJ%26hl"><i class='ai ai-google-scholar-square'></i></a>
<a href=https://www.researchgate.net/profile/Kevin_Cazelles><i class='ai ai-researchgate-square'></i></a>
<a href=https://kevcaz.github.io/index.xml><i class="fas fa-rss-square"></i></a></div><div class=footer-custom>Website built with <a href=https://gohugo.io/>Hugo</a>.<br><i class='fas fa-code'></i> available on <a href=https://github.com/KevCaz/KevCaz.github.io><i class='fab fa-github'></i></a>.<br>Content under <a href=https://creativecommons.org/publicdomain/zero/1.0><i class='fab fa-creative-commons'></i><i class='fab fa-creative-commons-zero'></i></a> unless otherwise specified.<br>Latest build: 01 Feb 2025 04:45 UTC</div></div></div><div class=ctn-sidebar-secondary><div class=ctt-sidebar-secondary><h1><a href=#><i class='far fas fa-chevron-up'></i></a></h1><script src=../../../../js/sidebar-secondary.js></script><h1><a onclick=scrollToBottom()><i class='far fas fa-chevron-down'></i></a></h1></div></div></div><script src=../../../../js/sidebar-primary-dropdown.js></script><script>scrollingElement=document.scrollingElement||document.body;function scrollToBottom(){scrollingElement.scrollTop=scrollingElement.scrollHeight}</script></body></html>